<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>数据展板</title>

<link rel="shortcut icon" href="image/favicon.png">
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/weui.min.css" />


</head>

<body>
	<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
	<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-gl/echarts-gl.min.js"></script>
	<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts-stat/ecStat.min.js"></script>
	<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/dataTool.min.js"></script>
	<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
	<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/world.js"></script>
	<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/extension/bmap.min.js"></script>
	<script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/simplex.js"></script>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/theme/shine.js"></script>
	<script type="text/javascript" src="js/deviceInfo.js"></script>
	<script type="text/javascript" src="js/rainbowInfo.js"></script>
	<script type="text/javascript" src="js/businessInfo.js"></script>
	<script type="text/javascript" src="js/ticketInfo.js"></script>


	<div class="weui-progress progressBar" >
		<div class="weui-progress__bar">
			<div class="weui-progress__inner-bar js_progress" style="width: 100%; background-color:#47a2fc;"></div>
		</div>
	</div>

	<div class="flex-wrap">
		<!-- 彩红用户情况 -->
		<div class="flex-item-1">
			<div class="div1">
				<div class="div1-item" id="div11"></div>
				<div class="div1-item" id="div12"></div>
			</div>

		</div>

		<!-- 业务办理量 -->
		<div class="flex-item-1">
			<div class="div1">
				<span class="title">业务办理量</span>
				<!-- 业务办理量 -->
				<div class="div2-item" id="div21">

					<div class="div2-child">
						<span id="realTimeCount" class="span-block" style="color: #ffbe46; font-size: 30px;">0</span> <span class="span-block text-1">实时累计(笔)</span>
						<div>
							<div class="yao realtimebus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao realtimebus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao realtimebus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao realtimebus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
						</div>
					</div>
					<div class="div2-child">
						<span id="weekCount" class="span-block" style="color: #ffa586; font-size: 30px;">-</span> <span class="span-block text-1">本周累计(笔)</span>
						<div>
							<div class="yao weekbus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao weekbus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao weekbus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao weekbus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
						</div>
					</div>
					<div class="div2-child">
						<span id="monthCount" class="span-block" style="color: #f25d5a; font-size: 30px;">0</span> <span class="span-block text-1">本月累计(笔)</span>
						<div>
							<div class="yao monthbus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao monthbus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao monthbus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
							<div class="yao monthbus">
								<span class="text-3">暂无</span><span class="text-2 m-l-15">-</span>
							</div>
						</div>
					</div>

				</div>

				<!-- 办理量趋势图 -->
				<div class="div1-item" id="div22"></div>
			</div>
		</div>


		<!-- 即开票销售趋势图 -->
		<div class="flex-item-1">
			<div class="div1">
				<div class="div3-item-1" id="div31"></div>

				<div class="div3-item-2" id="div32" style="margin: 10px;">
					<span class="title">即开票销售量</span>

					<div class="div2-item" style="margin-top: 10px; margin-bottom: 10px;">

						<div class="div3-child">
							<div>
								<span class="span-block text-4" id="realtimeTotalMoney">-</span><span class="span-block text-5" id="realtimeTotalCount">实时/-张</span>
							</div>
							<div>
								<span class="span-block text-4" id="weekTotalMoney">-</span><span class="span-block text-5" id="weekTotalCount">本周/-张</span>
							</div>
							<div>
								<span class="span-block text-4" id="monthTotalMoney">-</span><span class="span-block text-5" id="monthTotalCount">本月/-张</span>
							</div>
						</div>

						<div class="div3-child">
							<div>
								<span class="span-block text-6 money-5" id="realtimeMoney5">-元</span><span class="span-block text-7" id="realtimeCount5">-张/-张</span>
							</div>
							<div>
								<span class="span-block text-6 money-5" id="weekMoney5">-元</span><span class="span-block text-7" id="weekCount5">-张/-张</span>
							</div>
							<div>
								<span class="span-block text-6 money-5" id="monthMoney5">-元</span><span class="span-block text-7" id="monthCount5">-张/-张</span>
							</div>
						</div>

						<div class="div3-child">
							<div>
								<span class="span-block text-6 money-10" id="realtimeMoney10">-元</span><span class="span-block text-7" id="realtimeCount10">-张/-张</span>
							</div>
							<div>
								<span class="span-block text-6 money-10" id="weekMoney10">-元</span><span class="span-block text-7" id="weekCount10">-张/-张</span>
							</div>
							<div>
								<span class="span-block text-6 money-10" id="monthMoney10">-元</span><span class="span-block text-7" id="monthCount10">-张/-张</span>
							</div>
						</div>

						<div class="div3-child">
							<div>
								<span class="span-block text-6 money-20" id="realtimeMoney20">-元</span><span class="span-block text-7" id="realtimeCount20">-张/-张</span>
							</div>
							<div>
								<span class="span-block text-6 money-20" id="weekMoney20">-元</span><span class="span-block text-7" id="weekCount20">-张/-张</span>
							</div>
							<div>
								<span class="span-block text-6 money-20" id="monthMoney20">-元</span><span class="span-block text-7" id="monthCount20">-张/-张</span>
							</div>
						</div>


					</div>


				</div>
			</div>
		</div>


		<!-- 代金券发放兑换情况 -->
		<div class="flex-item-2">
			<div class="div5">
				<span class="title">代金券发放、兑换情况</span>
				<div class="div4-child">
					<div>
						<span class="text-8" id="vRealtimeTotalMoney">-</span><span class="text-13"></span><span id="vRealtimeTotalCount" class="text-8"></span><br> <span class="text-12">实时兑换(元)</span>
					</div>
					<div>
						<span class="text-10" id="vTotalMoney">-</span><span class="text-13">/</span><span id="vTotalCount" class="text-11">-</span><br> <span class="text-12">累计兑换(元)/发放量(张)</span>
					</div>
				</div>

				<table>

					<th>
					<td>福彩联名</td>
					<td>物美联名</td>
					<td>移动厅活动</td>
					<td>音乐节活动</td>
					</th>
					<tr>
						<td>兑换(元)</td>
						<td>-</td>
						<td>-</td>
						<td>-</td>
						<td>-</td>
					</tr>
					<tr>
						<td>发放额(元)</td>
						<td>-</td>
						<td>-</td>
						<td id="activeMoney">-</td>
						<td>-</td>
					</tr>
					<tr>
						<td>兑换(张)</td>
						<td>-</td>
						<td>-</td>
						<td>-</td>
						<td>-</td>
					</tr>
					<tr>
						<td>发放量(张)</td>
						<td>-</td>
						<td>-</td>
						<td id="vActiveCount">-</td>
						<td>-</td>
					</tr>
				</table>

			</div>


		</div>

		<!-- 设备运行情况 -->
		<div class="flex-item-2">
			<div class="div5">
				<div class="div5-item" id="div51"></div>
				<div class="vline"></div>
				<div class="div5-item" id="div52"></div>
			</div>
		</div>

		<!-- 即开票中奖情况 -->
		<div class="flex-item-2">
			<div id="div6">
				<span class="undo">即开票中奖情况</span>
			</div>
		</div>
	</div>

	<script type="text/javascript">
		// 第一次进入页面首先刷新一遍数据
		window.onload = function() {
			refreshData();

			// 后续每隔一定时间自动刷新所有数据
			setInterval(refreshData, 60000);
			
			setInterval(timerCount, 1000);
		};

		// 刷新数据统一入口
		function refreshData() {
			getRainbowInfo();
			getDeviceInfo();
			getBusinessInfo();
			getTicketInfo();
			getVoucherInfo();
		}
	</script>
	
	<!-- 倒计时 -->
	<script type="text/javascript">
		var timer = 60;
		var timerCount = function() {
			timer = timer - 1;
			if (timer < 0) {
				timer = 60;
			}

			$(".weui-progress__inner-bar").width(timer / 60 * 100 + "%");
		}
	</script>

	<!-- 移动业务办理情况 -->
	<script type="text/javascript">
		function getBusinessInfo() {
			$.ajax({
				url : "getBusinessInfo",
				type : "GET",
				error : function(xmlHttpRequest, error) {
					console.log("----------------3");
				},
				success : function(resp) {
					console.log(resp);

					$('#realTimeCount').html(resp.realTimeCount);
					$('#weekCount').html(resp.weekCount);
					$('#monthCount').html(resp.monthCount);
					
					// 下面是实时累计
					$('.realtimebus').each(function(index, element) {
						if (resp.realTimeList.length==index+1)
							return;
						
						var title = resp.realTimeList[index]['Product_name'];
						if (title.length>5) {
							title = title.substring(0, 5);
						}
						
						$(this).find('.text-3').html(title);
						$(this).find('.text-2').html(resp.realTimeList[index]['YW_count']);
					})
					
					// 下面是本周累计
					$('.weekbus').each(function(index, element) {
						if (index<resp.weekList.length) {
							var title = resp.weekList[index]['Product_name'];
							if (title.length>5) {
								title = title.substring(0, 5);
							}
							
							$(this).find('.text-3').html(title);
							$(this).find('.text-2').html(resp.weekList[index]['YW_count']);
						}						
					})
					
					// 下面是本月累计
					$('.monthbus').each(function(index, element) {
						if (index<resp.monthList.length) {
							var title = resp.monthList[index]['Product_name'];
							if (title.length>5) {
								title = title.substring(0, 5);
							}
							
							$(this).find('.text-3').html(title);
							$(this).find('.text-2').html(resp.monthList[index]['YW_count']);
						}
						
					})
					

					showBusinessInfo2("div22", resp);
				}
			});
		}
	</script>

	<!-- 彩红信息 -->
	<script type="text/javascript">
		function getRainbowInfo() {

			showRainbowInfo1("div11");

			$.ajax({
				url : "getRainbowInfo",
				type : "GET",
				error : function(xmlHttpRequest, error) {
					console.log("----------------2" + error);
				},
				success : function(resp) {
					console.log(resp);
					showRainbowInfo2("div12", resp);
				}
			});
		}
	</script>

	<!-- 设备运行情况 -->
	<script type="text/javascript">
		function getDeviceInfo() {
			$.ajax({
				url : "getDeviceInfo",
				type : "GET",
				error : function(xmlHttpRequest, error) {
					console.log("----------------1");
				},
				success : function(resp) {
					console.log(resp);
					showDeviceInfo1("div51", resp);
					showDeviceInfo2("div52", resp);
				}
			});
		}
	</script>

	<!-- 即开票销售 -->
	<script type="text/javascript">
		function getTicketInfo() {
			$.ajax({
				url : "getTicketInfo",
				type : "GET",
				error : function(xmlHttpRequest, error) {
					console.log("----------------10");
				},
				success : function(resp) {
					console.log(resp);
					showTicketInfo1("div31", resp);
					
					// 总
					$('#realtimeTotalMoney').html(resp.realtimeSellTotal[0]['TT_money']);
					$('#realtimeTotalMoney').css("color", "#7379fe");
					$('#realtimeTotalCount').html('实时/'+resp.realtimeSellTotal[0]['TT_num']+"张");
					
					$('#weekTotalMoney').html(resp.weekSellTotal[0]['TT_money']);
					$('#weekTotalMoney').css("color", "#71adfc");
					$('#weekTotalCount').html('本周/'+resp.weekSellTotal[0]['TT_num']+"张");
					
					$('#monthTotalMoney').html(resp.monthSellTotal[0]['MTT_money']);
					$('#monthTotalMoney').css("color", "#47a2fc");
					$('#monthTotalCount').html('本月/'+resp.monthSellTotal[0]['MTT_num']+"张");
					
					var realtimeData = new Array(0,0,0,0,0,0,0,0,0);
					var weekData = new Array(0,0,0,0,0,0,0,0,0);
					var monthData = new Array(0,0,0,0,0,0,0,0,0);
					
					for (let index in resp.realtimeSellInfo) {
						var m = resp.realtimeSellInfo[index];
						if (m['ptype']==5){
							realtimeData[0] = m['pmoney'];
							realtimeData[1] = m['pcount'];
						} else if (m['ptype']==10){
							realtimeData[3] = m['pmoney'];
							realtimeData[4] = m['pcount'];
						} else if (m['ptype']==20){
							realtimeData[6] = m['pmoney'];
							realtimeData[7] = m['pcount'];
						} 
					}
					
					for (let index in resp.realtimeSellCount) {
						var m = resp.realtimeSellCount[index];
						if (m['ptype']==5){
							realtimeData[2] = m['cplt_count'];
						} else if (m['ptype']==10){
							realtimeData[5] = m['cplt_count'];
						} else if (m['ptype']==20){
							realtimeData[8] = m['cplt_count'];
						} 
					}
					
					
					for (let index in resp.weekSellInfo) {
						var m = resp.weekSellInfo[index];
						if (m['ptype']==5){
							weekData[0] = m['pmoney'];
							weekData[1] = m['pcount'];
						} else if (m['ptype']==10){
							weekData[3] = m['pmoney'];
							weekData[4] = m['pcount'];
						} else if (m['ptype']==20){
							weekData[6] = m['pmoney'];
							weekData[7] = m['pcount'];
						} 
					}
					
					for (let index in resp.weekSellCount) {
						var m = resp.weekSellCount[index];
						if (m['ptype']==5){
							weekData[2] = m['wplt_count'];
						} else if (m['ptype']==10){
							weekData[5] = m['wplt_count'];
						} else if (m['ptype']==20){
							weekData[8] = m['wplt_count'];
						} 
					}
					
					for (let index in resp.monthSellInfo) {
						var m = resp.monthSellInfo[index];
						if (m['ptype']==5){
							monthData[0] = m['pmoney'];
							monthData[1] = m['pcount'];
						} else if (m['ptype']==10){
							monthData[3] = m['pmoney'];
							monthData[4] = m['pcount'];
						} else if (m['ptype']==20){
							monthData[6] = m['pmoney'];
							monthData[7] = m['pcount'];
						} 
					}
					
					for (let index in resp.monthSellCount) {
						var m = resp.monthSellCount[index];
						if (m['ptype']==5){
							monthData[2] = m['mplt_count'];
						} else if (m['ptype']==10){
							monthData[5] = m['mplt_count'];
						} else if (m['ptype']==20){
							monthData[8] = m['mplt_count'];
						} 
					}
					
					$('#realtimeMoney5').html(realtimeData[0]+"元")
					$('#realtimeCount5').html(realtimeData[1]+"张/"+realtimeData[2]+"张")
					$('#weekMoney5').html(weekData[0]+"元")
					$('#weekCount5').html(weekData[1]+"张/"+weekData[2]+"张")
					$('#monthMoney5').html(monthData[0]+"元")
					$('#monthCount5').html(monthData[1]+"张/"+monthData[2]+"张")
					
					$('#realtimeMoney10').html(realtimeData[3]+"元")
					$('#realtimeCount10').html(realtimeData[4]+"张/"+realtimeData[5]+"张")
					$('#weekMoney10').html(weekData[3]+"元")
					$('#weekCount10').html(weekData[4]+"张/"+weekData[5]+"张")
					$('#monthMoney10').html(monthData[3]+"元")
					$('#monthCount10').html(monthData[4]+"张/"+monthData[5]+"张")
					
					$('#realtimeMoney20').html(realtimeData[6]+"元")
					$('#realtimeCount20').html(realtimeData[7]+"张/"+realtimeData[8]+"张")
					$('#weekMoney20').html(weekData[6]+"元")
					$('#weekCount20').html(weekData[7]+"张/"+weekData[8]+"张")
					$('#monthMoney20').html(monthData[6]+"元")
					$('#monthCount20').html(monthData[7]+"张/"+monthData[8]+"张")
				}
			});
		}
	</script>

	<!-- 代金券 -->
	<script type="text/javascript">
		function getVoucherInfo() {
			$.ajax({
				url : "getVoucherInfo",
				type : "GET",
				error : function(xmlHttpRequest, error) {
					console.log("----------------14");
				},
				success : function(resp) {
					console.log(resp);

					$('#vRealtimeTotalMoney').html(resp.CP_money);
					
					$('#vTotalMoney').html(resp.total.Tot_money);
					$('#vTotalCount').html(resp.total.Tot_p);
					
					$('#vActiveCount').html(resp.active.CP_num);
				}
			});
		}
	</script>


</body>
</html>